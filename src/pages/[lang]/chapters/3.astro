---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { languages, getTranslations } from "../../../lib/i18n";
import { ArrowLeft, ArrowRight } from "lucide-astro";

// Components
import ChapterHero from "../../../components/chapters/3/ChapterHero.astro";
import MainSettlements from "../../../components/chapters/3/MainSettlements.astro";
import HouseholdDetails from "../../../components/chapters/3/HouseholdDetails.astro";
import PopulationDistribution from "../../../components/chapters/3/PopulationDistribution.astro";
import AgeGroup from "../../../components/chapters/3/AgeGroup.astro";
import LanguageDistribution from "../../../components/chapters/3/LanguageDistribution.astro";
import ReligionDistribution from "../../../components/chapters/3/ReligionDistribution.astro";
import EthnicityDistribution from "../../../components/chapters/3/EthnicityDistribution.astro";
import HouseholdHead from "../../../components/chapters/3/HouseholdHead.astro";
import OccupationDistribution from "../../../components/chapters/3/OccupationDistribution.astro";
import EconomicActiveDistribution from "../../../components/chapters/3/EconomicActiveDistribution.astro";
import DisabilityDistribution from "../../../components/chapters/3/DisabilityDistribution.astro";
import MigrationDetails from "../../../components/chapters/3/MigrationDetails.astro";
import VitalEvents from "../../../components/chapters/3/VitalEvents.astro";
import SocialSecurity from "../../../components/chapters/3/SocialSecurity.astro";

export async function getStaticPaths() {
    return Object.keys(languages).map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;
if (!(lang in languages)) {
    return Astro.redirect("/ne/chapters/3");
}

const t = await getTranslations(lang as keyof typeof languages);
const pageTitle = t.chapters[3].title;
const description = t.chapters[3].description || pageTitle;
---

<BaseLayout
    title={pageTitle}
    description={description}
    lang={lang as any}
    currentChapter={3}
>
    <main class="bg-[#050505] min-h-screen">
        <ChapterHero lang={lang as any} />

        <div class="relative overflow-hidden">
            <MainSettlements lang={lang as any} />
            <HouseholdDetails lang={lang as any} />
            <PopulationDistribution lang={lang as any} />
            <AgeGroup lang={lang as any} />
            <LanguageDistribution lang={lang as any} />
            <ReligionDistribution lang={lang as any} />
            <EthnicityDistribution lang={lang as any} />
            <HouseholdHead lang={lang as any} />
            <OccupationDistribution lang={lang as any} />
            <EconomicActiveDistribution lang={lang as any} />
            <DisabilityDistribution lang={lang as any} />
            <MigrationDetails lang={lang as any} />
            <VitalEvents lang={lang as any} />
            <SocialSecurity lang={lang as any} />
        </div>

        <!-- Chapter Navigation -->
        <section
            class="relative bg-[#050505] py-8 md:py-12 border-t border-zinc-900"
        >
            <div class="container mx-auto px-8 relative z-10">
                <nav
                    class="w-full mx-auto flex flex-row items-center justify-between gap-4"
                >
                    <a
                        href={`/${lang}/chapters/2`}
                        class="group flex items-center gap-3 text-zinc-500 hover:text-white transition-all duration-300"
                    >
                        <div
                            class="w-8 h-8 md:w-10 md:h-10 flex items-center justify-center rounded-full border border-white/10 bg-white/5 group-hover:bg-white/10 group-hover:border-white/20 transition-all duration-300"
                        >
                            <ArrowLeft
                                class="w-4 h-4 md:w-5 md:h-5 transition-transform duration-300 group-hover:-translate-x-1"
                            />
                        </div>
                        <span
                            class="font-serif text-base md:text-lg tracking-wide whitespace-nowrap"
                            >{
                                lang === "ne" ? "परिच्छेद – २" : "Chapter 2"
                            }</span
                        >
                    </a>

                    <a
                        href={`/${lang}/chapters/4`}
                        class="group flex flex-row items-center gap-3 text-white hover:text-obsidian-accent transition-all duration-300"
                    >
                        <span
                            class="font-serif text-base md:text-lg tracking-wide whitespace-nowrap"
                            >{
                                lang === "ne" ? "परिच्छेद – ४" : "Chapter 4"
                            }</span
                        >
                        <div
                            class="w-8 h-8 md:w-10 md:h-10 flex items-center justify-center rounded-full border border-white/10 bg-white/5 group-hover:bg-white/10 group-hover:border-white/20 transition-all duration-300"
                        >
                            <ArrowRight
                                class="w-4 h-4 md:w-5 md:h-5 transition-transform duration-300 group-hover:translate-x-1"
                            />
                        </div>
                    </a>
                </nav>
            </div>
        </section>
    </main>
</BaseLayout>
