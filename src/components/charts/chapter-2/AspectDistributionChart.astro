---
import type { Language } from "../../../lib/i18n";
import { loadChapterSection } from "../../../lib/i18n/chapter-loader";

interface Props {
    lang: Language;
}

const { lang } = Astro.props;
const locale = lang === "ne" ? "ne-NP" : "en-US";
const t = {
    aspect: lang === "ne" ? "जमिनको मोहडा" : "Aspect",
    areaSqKm: lang === "ne" ? "क्षेत्रफल (वर्ग कि.मि.)" : "Area (sq km)",
    areaPercent: lang === "ne" ? "क्षेत्रफल प्रतिशतमा" : "Area (%)",
    total: lang === "ne" ? "जम्मा" : "Total",
    source: lang === "ne" ? "स्रोत" : "Source",
};

const content = await loadChapterSection<any>(2, "terrain-aspect", lang);

if (!content) {
    throw new Error("Aspect data not found");
}

const data = content.tableData;
---

<div class="space-y-6">
    <h4
        class="font-serif text-xl md:text-2xl text-white font-medium text-center font-bold"
    >
        {content.tableTitle}
    </h4>

    <!-- Data Table -->
    <div class="overflow-x-auto">
        <table
            class="w-full border-collapse bg-[#0a0a0a] border border-[#f2e25d]/10"
        >
            <thead>
                <tr class="bg-[#f2e25d]/5 border-b border-[#f2e25d]/20">
                    <th
                        class="px-4 py-3 text-left font-serif text-zinc-100 font-medium border-r border-[#f2e25d]/10"
                        >{t.aspect}</th
                    >
                    <th
                        class="px-4 py-3 text-right font-serif text-zinc-100 font-medium border-r border-[#f2e25d]/10"
                        >{t.areaSqKm}</th
                    >
                    <th
                        class="px-4 py-3 text-right font-serif text-zinc-100 font-medium"
                        >{t.areaPercent}</th
                    >
                </tr>
            </thead>
            <tbody>
                {
                    data.map((row: any) => (
                        <tr class="border-b border-[#f2e25d]/5 hover:bg-[#f2e25d]/5 transition-colors duration-200">
                            <td class="px-4 py-3 font-serif text-zinc-100 border-r border-[#f2e25d]/5">
                                {row.aspect}
                            </td>
                            <td class="px-4 py-3 font-serif text-zinc-100 text-right border-r border-[#f2e25d]/5">
                                {row.area.toLocaleString(locale, {
                                    minimumFractionDigits: 2,
                                    maximumFractionDigits: 2,
                                })}
                            </td>
                            <td class="px-4 py-3 font-serif text-zinc-100 text-right">
                                {row.percentage.toLocaleString(locale, {
                                    minimumFractionDigits: 2,
                                    maximumFractionDigits: 2,
                                })}
                            </td>
                        </tr>
                    ))
                }
                <tr
                    class="bg-[#f2e25d]/10 border-t-2 border-[#f2e25d]/30 font-medium"
                >
                    <td
                        class="px-4 py-3 font-serif text-zinc-100 border-r border-[#f2e25d]/10"
                        >{t.total}</td
                    >
                    <td
                        class="px-4 py-3 font-serif text-zinc-100 text-right border-r border-[#f2e25d]/10"
                    >
                        {
                            content.total.area.toLocaleString(locale, {
                                minimumFractionDigits: 2,
                                maximumFractionDigits: 2,
                            })
                        }
                    </td>
                    <td class="px-4 py-3 font-serif text-zinc-100 text-right">
                        {
                            content.total.percentage.toLocaleString(locale, {
                                minimumFractionDigits: 2,
                                maximumFractionDigits: 2,
                            })
                        }
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <p class="text-zinc-400 font-serif text-sm italic text-center">
        {t.source}: {content.source}
    </p>
</div>
