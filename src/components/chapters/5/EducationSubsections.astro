---
import type { Language } from "../../../lib/i18n";
import { loadChapterSections } from "../../../lib/i18n/chapter-loader";
import { formatNumber } from "../../../lib/i18n/formatters";
import LiteracyChart from "../../charts/chapter-5/LiteracyChart.astro";
import SchoolEnrollmentChart from "../../charts/chapter-5/SchoolEnrollmentChart.astro";

interface Props {
    lang: Language;
}

const { lang } = Astro.props;

// Load all education subsections
const subsections = await loadChapterSections(
    5,
    ["literacy-stats", "schools-list", "teachers-staff"],
    lang,
);
---

<div class="bg-[#050505]">
    <div class="container mx-auto px-8">
        <div class="w-full space-y-12">
            <!-- Literacy Statistics -->
            {
                subsections["literacy-stats"] && (
                    <div id="literacy-stats" class="space-y-6">
                        <h3 class="font-serif text-2xl md:text-3xl text-zinc-100 font-medium">
                            {formatNumber("5.1.1", lang)} {subsections["literacy-stats"].title}
                        </h3>
                        <p class="text-zinc-100 font-serif text-lg md:text-xl font-light leading-relaxed">
                            {subsections["literacy-stats"].intro}
                        </p>

                        <!-- Literacy Chart -->
                        <div class="my-8">
                            <LiteracyChart lang={lang} />
                        </div>

                        <!-- Formal Education Stats -->
                        <div class="bg-[#0a0a0a] border border-[#f2e25d]/10 p-6 md:p-8">
                            <h4 class="font-serif text-xl md:text-2xl text-zinc-100 font-medium mb-4">
                                {subsections["literacy-stats"].formalEducation.title}
                            </h4>
                            <p class="text-zinc-100 font-serif text-base md:text-lg font-light mb-4">
                                {lang === "ne" ? "आयु समूह:" : "Age Group:"} {subsections["literacy-stats"].formalEducation.ageGroup}
                            </p>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-[#050505] p-4 border border-[#f2e25d]/5">
                                    <div class="text-[#f2e25d] text-3xl font-bold mb-2">
                                        {formatNumber(subsections["literacy-stats"].formalEducation.currentlyAttending.percent, lang)}%
                                    </div>
                                    <div class="text-zinc-100 font-serif text-sm">
                                        {lang === "ne" ? "हाल विद्यालय/कलेज गएका" : "Currently attending school/college"}
                                    </div>
                                </div>
                                <div class="bg-[#050505] p-4 border border-[#f2e25d]/5">
                                    <div class="text-[#f2e25d] text-3xl font-bold mb-2">
                                        {formatNumber(subsections["literacy-stats"].formalEducation.previouslyAttended.percent, lang)}%
                                    </div>
                                    <div class="text-zinc-100 font-serif text-sm">
                                        {lang === "ne" ? "पहिला विद्यालय/कलेज गएका" : "Previously attended school/college"}
                                    </div>
                                </div>
                                <div class="bg-[#050505] p-4 border border-[#f2e25d]/5">
                                    <div class="text-[#f2e25d] text-3xl font-bold mb-2">
                                        {formatNumber(subsections["literacy-stats"].formalEducation.neverAttended.percent, lang)}%
                                    </div>
                                    <div class="text-zinc-100 font-serif text-sm">
                                        {lang === "ne" ? "कहिले विद्यालय/कलेज नगएका" : "Never attended school/college"}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                )
            }

            <!-- Schools List -->
            {
                subsections["schools-list"] && (
                    <div id="schools-list" class="space-y-6">
                        <h3 class="font-serif text-2xl md:text-3xl text-zinc-100 font-medium">
                            {formatNumber("5.1.2", lang)} {subsections["schools-list"].title}
                        </h3>

                        <!-- Community Schools -->
                        <div class="space-y-4">
                            <h4 class="font-serif text-xl md:text-2xl text-zinc-100 font-medium">
                                {lang === "ne" ? "क)" : "a)"} {subsections["schools-list"].communitySchools.title}
                            </h4>
                            <div class="bg-[#0a0a0a] border border-[#f2e25d]/10 overflow-hidden">
                                <div class="overflow-x-auto">
                                    <table class="w-full">
                                        <thead class="bg-[#050505] border-b border-[#f2e25d]/20">
                                            <tr>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "क्र.सं." : "SN"}</th>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "विद्यालयको नाम" : "School Name"}</th>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "ठेगाना" : "Address"}</th>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "विद्यार्थी" : "Students"}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {subsections["schools-list"].communitySchools.schools.map((school: any) => (
                                                <tr class="border-b border-[#f2e25d]/5 hover:bg-[#050505] transition-colors">
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{formatNumber(school.sn, lang)}</td>
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{school.name}</td>
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{school.address}</td>
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{formatNumber(school.students, lang)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Institutional Schools -->
                        <div class="space-y-4">
                            <h4 class="font-serif text-xl md:text-2xl text-zinc-100 font-medium">
                                {lang === "ne" ? "ख)" : "b)"} {subsections["schools-list"].institutionalSchools.title}
                            </h4>
                            <div class="bg-[#0a0a0a] border border-[#f2e25d]/10 overflow-hidden">
                                <div class="overflow-x-auto">
                                    <table class="w-full">
                                        <thead class="bg-[#050505] border-b border-[#f2e25d]/20">
                                            <tr>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "क्र.सं." : "SN"}</th>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "विद्यालयको नाम" : "School Name"}</th>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "ठेगाना" : "Address"}</th>
                                                <th class="px-4 py-3 text-left font-serif text-sm text-zinc-100">{lang === "ne" ? "विद्यार्थी" : "Students"}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {subsections["schools-list"].institutionalSchools.schools.map((school: any) => (
                                                <tr class="border-b border-[#f2e25d]/5 hover:bg-[#050505] transition-colors">
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{formatNumber(school.sn, lang)}</td>
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{school.name}</td>
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{school.address}</td>
                                                    <td class="px-4 py-3 font-serif text-sm text-zinc-100">{formatNumber(school.students, lang)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- School Enrollment Chart -->
                        <div class="my-8">
                            <SchoolEnrollmentChart lang={lang} />
                        </div>
                    </div>
                )
            }

            <!-- Teachers and Staff -->
            {
                subsections["teachers-staff"] && (
                    <div id="teachers-staff" class="space-y-6">
                        <h3 class="font-serif text-2xl md:text-3xl text-zinc-100 font-medium">
                            {formatNumber("5.1.4", lang)} {subsections["teachers-staff"].title}
                        </h3>

                        <!-- Quality Indicators -->
                        <div class="bg-[#0a0a0a] border border-[#f2e25d]/10 p-6 md:p-8">
                            <h4 class="font-serif text-xl text-zinc-100 font-medium mb-4">
                                {subsections["teachers-staff"].qualityIndicators.title}
                            </h4>
                            <ul class="space-y-2">
                                {subsections["teachers-staff"].qualityIndicators.indicators.map((indicator: string) => (
                                    <li class="text-zinc-100 font-serif text-base md:text-lg font-light flex items-start">
                                        <span class="mr-3 text-[#f2e25d]">•</span>
                                        <span>{indicator}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>

                        <!-- Child-Friendly Education -->
                        <div class="bg-[#0a0a0a] border border-[#f2e25d]/10 p-6 md:p-8">
                            <h4 class="font-serif text-xl text-zinc-100 font-medium mb-4">
                                {subsections["teachers-staff"].childFriendlyEducation.title}
                            </h4>
                            <ul class="space-y-2">
                                {subsections["teachers-staff"].childFriendlyEducation.initiatives.map((initiative: string) => (
                                    <li class="text-zinc-100 font-serif text-base md:text-lg font-light flex items-start">
                                        <span class="mr-3 text-[#f2e25d]">•</span>
                                        <span>{initiative}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    </div>
                )
            }
        </div>
    </div>
</div>
