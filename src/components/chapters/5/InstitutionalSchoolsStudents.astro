---
import type { Language } from "../../../lib/i18n";
import ne from "../../../lib/i18n/chapters/5/institutional-schools-students/ne.json";
import en from "../../../lib/i18n/chapters/5/institutional-schools-students/en.json";

interface Props {
    lang: Language;
}

const { lang } = Astro.props;
const t = lang === "ne" ? ne : en;

// Number formatter for Nepali
const formatNumber = (num: number | string | undefined) => {
    if (num === undefined || num === null) return "0";
    if (num === "") return "-";
    const str = num.toString();
    if (lang === "en") return str;
    return str.replace(/[0-9]/g, (d) => "०१२३४५६७८९"[parseInt(d)]);
};

const headers = {
    ne: {
        sn: "क्र.सं.",
        schoolName: "विद्यालयको नाम",
        ecd: "बाल विकास केन्द्र",
        class1_5: "कक्षा १-५",
        class6_8: "कक्षा ६-८",
        class9_10: "कक्षा ९-१०",
        class11_12: "कक्षा ११-१२",
        f: "छात्रा",
        m: "छात्र",
        t: "जम्मा",
        total: "जम्मा",
    },
    en: {
        sn: "SN",
        schoolName: "School Name",
        ecd: "ECD",
        class1_5: "Class 1-5",
        class6_8: "Class 6-8",
        class9_10: "Class 9-10",
        class11_12: "Class 11-12",
        f: "F",
        m: "M",
        t: "T",
        total: "Total",
    },
};

const h = lang === "ne" ? headers.ne : headers.en;
---

<section
    id="institutional-schools-students"
    class="relative py-20 bg-[#0a0a0a] border-t border-white/5"
>
    <div class="container mx-auto px-8 relative z-10">
        <!-- Main Title -->
        <h2 class="text-2xl md:text-3xl font-serif text-white/90 mb-12">
            {t.title}
        </h2>

        <div class="mb-16">
            <h3 class="text-xl font-serif text-white/80 mb-6">
                {t.tableTitle}
            </h3>
            <div class="rounded-lg overflow-hidden border border-zinc-800">
                <div class="overflow-x-auto">
                    <table
                        class="w-full text-sm text-left text-zinc-100 border-collapse"
                    >
                        <thead class="border-b border-zinc-700">
                            <tr>
                                <th
                                    rowspan="2"
                                    class="px-3 py-2 border-r border-zinc-800 border-b border-b-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.sn}</th
                                >
                                <th
                                    rowspan="2"
                                    class="px-3 py-2 border-r border-zinc-800 border-b border-b-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.schoolName}</th
                                >
                                <th
                                    colspan="3"
                                    class="px-2 py-1 text-center border-r border-zinc-800 border-b border-b-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.ecd}</th
                                >
                                <th
                                    colspan="3"
                                    class="px-2 py-1 text-center border-r border-zinc-800 border-b border-b-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.class1_5}</th
                                >
                                <th
                                    colspan="3"
                                    class="px-2 py-1 text-center border-r border-zinc-800 border-b border-b-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.class6_8}</th
                                >
                                <th
                                    colspan="3"
                                    class="px-2 py-1 text-center border-r border-zinc-800 border-b border-b-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.class9_10}</th
                                >
                                <th
                                    colspan="3"
                                    class="px-2 py-1 text-center border-r border-zinc-800 border-b border-b-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.class11_12}</th
                                >
                                <th
                                    colspan="3"
                                    class="px-2 py-1 text-center border-b border-zinc-800 font-serif font-medium text-zinc-300"
                                    >{h.total}</th
                                >
                            </tr>
                            <tr>
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.f}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.m}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.t}</th
                                >

                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.f}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.m}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.t}</th
                                >

                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.f}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.m}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.t}</th
                                >

                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.f}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.m}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.t}</th
                                >

                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.f}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.m}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.t}</th
                                >

                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.f}</th
                                >
                                <th
                                    class="px-2 py-1 border-r border-zinc-800 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.m}</th
                                >
                                <th
                                    class="px-2 py-1 text-center text-xs font-serif font-medium text-zinc-400"
                                    >{h.t}</th
                                >
                            </tr>
                        </thead>
                        <tbody>
                            {
                                t.data.map((school) => (
                                    <tr class="border-b border-zinc-800 hover:bg-zinc-900/30 transition-colors">
                                        <td class="px-3 py-2 whitespace-nowrap text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.sn)}
                                        </td>
                                        <td class="px-3 py-2 font-medium text-white border-r border-zinc-800 text-xs">
                                            {school.name}
                                        </td>

                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.ecd?.f)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.ecd?.m)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-white font-bold border-r border-zinc-800 text-xs">
                                            {formatNumber(school.ecd?.t)}
                                        </td>

                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c1_5?.f)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c1_5?.m)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-white font-bold border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c1_5?.t)}
                                        </td>

                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c6_8?.f)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c6_8?.m)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-white font-bold border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c6_8?.t)}
                                        </td>

                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c9_10?.f)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c9_10?.m)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-white font-bold border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c9_10?.t)}
                                        </td>

                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c11_12?.f)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c11_12?.m)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-white font-bold border-r border-zinc-800 text-xs">
                                            {formatNumber(school.c11_12?.t)}
                                        </td>

                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.total?.f)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-zinc-300 border-r border-zinc-800 text-xs">
                                            {formatNumber(school.total?.m)}
                                        </td>
                                        <td class="px-2 py-2 text-center text-white font-bold text-xs">
                                            {formatNumber(school.total?.t)}
                                        </td>
                                    </tr>
                                ))
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
