---
import type { Language } from "../../../lib/i18n";
import { loadChapterSection } from "../../../lib/i18n/chapter-loader";
import { formatNumber } from "../../../lib/i18n/formatters";

interface Props {
    lang: Language;
}

const { lang } = Astro.props;

const content = await loadChapterSection(5, "peace-security", lang);

if (!content) {
    throw new Error("Peace security section content not found");
}
---

<section id="peace-security" class="relative bg-[#050505] py-8 md:py-12">
    <div class="container mx-auto px-8">
        <div class="w-full space-y-12">
            <!-- Peace & Security Header -->
            <div class="space-y-6">
                <h2
                    class="font-serif text-3xl md:text-4xl font-medium text-zinc-100"
                >
                    {formatNumber("5.6", lang)}
                    {content.title}
                </h2>
                <p
                    class="text-zinc-100 font-serif text-lg md:text-xl font-light leading-relaxed"
                >
                    {content.intro}
                </p>
            </div>

            <!-- Security Forces -->
            <div id="security-forces" class="space-y-6">
                <h3
                    class="font-serif text-2xl md:text-3xl text-zinc-100 font-medium"
                >
                    {content.securityForces.title}
                </h3>
                <div
                    class="bg-[#0a0a0a] border border-[#f2e25d]/10 overflow-hidden"
                >
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead
                                class="bg-[#050505] border-b border-[#f2e25d]/20"
                            >
                                <tr>
                                    <th
                                        class="px-4 py-3 text-left font-serif text-sm text-zinc-100"
                                        >{lang === "ne" ? "क्र.सं." : "SN"}</th
                                    >
                                    <th
                                        class="px-4 py-3 text-left font-serif text-sm text-zinc-100"
                                        >{
                                            lang === "ne"
                                                ? "सुरक्षा निकायहरूको नाम"
                                                : "Security Force Name"
                                        }</th
                                    >
                                    <th
                                        class="px-4 py-3 text-left font-serif text-sm text-zinc-100"
                                        >{
                                            lang === "ne"
                                                ? "रहेको स्थान"
                                                : "Location"
                                        }</th
                                    >
                                </tr>
                            </thead>
                            <tbody>
                                {
                                    content.securityForces.forces.map(
                                        (force: any) => (
                                            <tr class="border-b border-[#f2e25d]/5 hover:bg-[#050505] transition-colors">
                                                <td class="px-4 py-3 font-serif text-sm text-zinc-100">
                                                    {formatNumber(
                                                        force.sn,
                                                        lang,
                                                    )}
                                                </td>
                                                <td class="px-4 py-3 font-serif text-sm text-zinc-100">
                                                    {force.name}
                                                </td>
                                                <td class="px-4 py-3 font-serif text-sm text-zinc-100">
                                                    {force.location}
                                                </td>
                                            </tr>
                                        ),
                                    )
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Crime Status -->
            <div class="bg-[#0a0a0a] border border-[#f2e25d]/10 p-6 md:p-8">
                <p
                    class="text-zinc-100 font-serif text-base md:text-lg font-light mb-4"
                >
                    {content.crimeStatus.intro}
                </p>
                <h4 class="font-serif text-lg text-zinc-100 font-medium mb-3">
                    {lang === "ne" ? "सामान्य समस्याहरू:" : "Common Issues:"}
                </h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                    {
                        content.crimeStatus.commonIssues.map(
                            (issue: string) => (
                                <div class="bg-[#050505] p-3 border border-[#f2e25d]/5 text-center">
                                    <span class="text-zinc-100 font-serif text-sm">
                                        {issue}
                                    </span>
                                </div>
                            ),
                        )
                    }
                </div>
            </div>

            <!-- Homeless Children -->
            <div class="bg-[#0a0a0a] border border-blue-500/20 p-6 md:p-8">
                <h4 class="font-serif text-xl text-zinc-100 font-medium mb-4">
                    {content.homelessChildren.title}
                </h4>
                <p
                    class="text-zinc-100 font-serif text-base md:text-lg font-light italic"
                >
                    {content.homelessChildren.constitutionalProvision}
                </p>
            </div>
        </div>
    </div>
</section>
