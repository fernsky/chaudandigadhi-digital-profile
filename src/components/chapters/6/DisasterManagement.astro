---
import { loadChapterSection } from "../../../lib/i18n/chapter-loader";
import type { Language } from "../../../lib/i18n";

interface Props {
    lang: Language;
}

const { lang } = Astro.props;

type DisasterManagementSection = {
    title: string;
    number: string;
    content: string;
};

type DisasterDamageSection = {
    title: string;
    number: string;
    content: string;
};

type DisasterRiskTimeSection = {
    title: string;
    number: string;
    tableNumber: string;
    tableTitle: string;
    tableData: Array<{
        sn: string;
        type: string;
        currentSituation: string;
        time: string;
    }>;
    source: string;
};

type DisasterPreparednessSection = {
    title: string;
    number: string;
    content: string;
};

type EmergencyTransportSection = {
    title: string;
    number: string;
    content: string;
};

const disasterManagement = (await loadChapterSection(6, "disaster-management", lang)) as DisasterManagementSection;
const disasterDamage = (await loadChapterSection(6, "disaster-damage", lang)) as DisasterDamageSection;
const disasterRiskTime = (await loadChapterSection(6, "disaster-risk-time", lang)) as DisasterRiskTimeSection;
const disasterPreparedness = (await loadChapterSection(6, "disaster-preparedness", lang)) as DisasterPreparednessSection;
const emergencyTransport = (await loadChapterSection(6, "emergency-transport", lang)) as EmergencyTransportSection;
---

<!-- 6.4 Disaster Management -->
{
    disasterManagement && (
        <section id="disaster-management" class="relative bg-[#050505] pb-8 md:pb-12">
            <div class="container mx-auto px-8">
                <div class="max-w-4xl mx-auto">
                    <div class="mb-6">
                        <h2 class="font-serif text-3xl md:text-4xl font-medium text-zinc-100 mb-6">
                            {disasterManagement.number} {disasterManagement.title}
                        </h2>
                    </div>
                    <p class="text-zinc-100 font-serif text-lg md:text-xl font-light leading-relaxed mb-10">
                        {disasterManagement.content}
                    </p>
                </div>
            </div>
        </section>
    )
}

<!-- 6.4.1 Disaster Damage -->
{
    disasterDamage && (
        <section id="disaster-damages" class="relative bg-[#050505] pb-8 md:pb-12">
            <div class="container mx-auto px-8">
                <div class="max-w-4xl mx-auto">
                    <div class="mb-6">
                        <h3 class="font-serif text-2xl md:text-3xl font-medium text-zinc-100 mb-6">
                            {disasterDamage.number} {disasterDamage.title}
                        </h3>
                    </div>
                    <p class="text-zinc-100 font-serif text-lg md:text-xl font-light leading-relaxed mb-10">
                        {disasterDamage.content}
                    </p>
                </div>
            </div>
        </section>
    )
}

<!-- 6.4.2 Disaster Risk Time (Table) -->
{
    disasterRiskTime && (
        <section id="disaster-risks" class="relative bg-[#050505] pb-8 md:pb-12">
            <div class="container mx-auto px-8">
                <div class="max-w-6xl mx-auto">
                    <div class="max-w-4xl mx-auto mb-6">
                        <h3 class="font-serif text-2xl md:text-3xl font-medium text-zinc-100 mb-6">
                            {disasterRiskTime.number} {disasterRiskTime.title}
                        </h3>
                    </div>

                    <!-- Risk Time Table -->
                    <div class="mb-4 max-w-6xl mx-auto">
                        <h5 class="font-serif text-xl md:text-2xl text-zinc-100 font-medium mb-4 text-center">
                            {disasterRiskTime.tableNumber}: {disasterRiskTime.tableTitle}
                        </h5>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse bg-[#0a0a0a] border border-[#f2e25d]/10 text-sm md:text-base">
                                <thead>
                                    <tr class="bg-[#f2e25d]/5 border-b border-[#f2e25d]/20">
                                        <th class="px-4 py-3 border-r border-[#f2e25d]/10 text-center w-16 font-serif text-zinc-100 font-medium">
                                            {lang === "ne" ? "क्र.सं." : "SN"}
                                        </th>
                                        <th class="px-4 py-3 border-r border-[#f2e25d]/10 text-left w-32 font-serif text-zinc-100 font-medium">
                                            {lang === "ne" ? "सम्भावित प्रकोप" : "Potential Disaster"}
                                        </th>
                                        <th class="px-4 py-3 border-r border-[#f2e25d]/10 text-left font-serif text-zinc-100 font-medium">
                                            {lang === "ne" ? "विद्यमान अवस्था" : "Current Situation"}
                                        </th>
                                        <th class="px-4 py-3 text-left w-32 font-serif text-zinc-100 font-medium">
                                            {lang === "ne" ? "समय" : "Time"}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {disasterRiskTime.tableData.map((row) => (
                                        <tr class="text-zinc-100 border-b border-[#f2e25d]/5 hover:bg-[#f2e25d]/5 transition-colors duration-200">
                                            <td class="px-4 py-3 border-r border-[#f2e25d]/5 text-center font-medium">
                                                {row.sn}
                                            </td>
                                            <td class="px-4 py-3 border-r border-[#f2e25d]/5 font-medium">
                                                {row.type}
                                            </td>
                                            <td class="px-4 py-3 border-r border-[#f2e25d]/5">
                                                {row.currentSituation}
                                            </td>
                                            <td class="px-4 py-3">
                                                {row.time}
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                        <p class="text-right text-zinc-400 text-sm mt-2 italic">
                            {lang === "ne" ? "स्रोत: " : "Source: "}{disasterRiskTime.source}
                        </p>
                    </div>
                </div>
            </div>
        </section>
    )
}

<!-- 6.4.3 Disaster Preparedness -->
{
    disasterPreparedness && (
        <section id="disaster-preparedness" class="relative bg-[#050505] pb-8 md:pb-12">
            <div class="container mx-auto px-8">
                <div class="max-w-4xl mx-auto">
                    <div class="mb-6">
                        <h3 class="font-serif text-2xl md:text-3xl font-medium text-zinc-100 mb-6">
                            {disasterPreparedness.number} {disasterPreparedness.title}
                        </h3>
                    </div>
                    <p class="text-zinc-100 font-serif text-lg md:text-xl font-light leading-relaxed mb-10">
                        {disasterPreparedness.content}
                    </p>
                </div>
            </div>
        </section>
    )
}

<!-- 6.4.4 Emergency Transport -->
{
    emergencyTransport && (
        <section id="emergency-transport" class="relative bg-[#050505] pb-8 md:pb-12">
            <div class="container mx-auto px-8">
                <div class="max-w-4xl mx-auto">
                    <div class="mb-6">
                        <h3 class="font-serif text-2xl md:text-3xl font-medium text-zinc-100 mb-6">
                            {emergencyTransport.number} {emergencyTransport.title}
                        </h3>
                    </div>
                    <p class="text-zinc-100 font-serif text-lg md:text-xl font-light leading-relaxed mb-10">
                        {emergencyTransport.content}
                    </p>
                </div>
            </div>
        </section>
    )
}
